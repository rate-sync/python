# rate-sync.toml - Tier Configuration

# ==============================================================================
# Store (coordination backend)
# ==============================================================================

[stores.redis]
engine = "redis"
url = "redis://localhost:6379/0"

# ==============================================================================
# Tiers (different limits per plan)
# ==============================================================================

# Free Tier - For startups/hobby
[limiters.free-tier]
store = "redis"
algorithm = "token_bucket"
rate_per_second = 0.16      # ~10 requests/minute
max_concurrent = 2          # Max 2 simultaneous requests
timeout = 10.0              # Wait up to 10s for slot

# Pro Tier - For small/medium businesses
[limiters.pro-tier]
store = "redis"
algorithm = "token_bucket"
rate_per_second = 1.66      # ~100 requests/minute
max_concurrent = 20         # Max 20 simultaneous requests
timeout = 30.0

# Enterprise Tier - For large companies
[limiters.enterprise-tier]
store = "redis"
algorithm = "token_bucket"
rate_per_second = 16.66     # ~1000 requests/minute
max_concurrent = 200        # Max 200 simultaneous requests
timeout = 60.0

# ==============================================================================
# HOW IT WORKS:
# ==============================================================================
#
# 1. Client sends request with header X-Tenant-ID: tenant-acme
# 2. Python code does lookup: tier = get_tenant_tier("tenant-acme") → "free-tier"
# 3. rate-sync loads limiter config "free-tier" from this file
# 4. Applies rate_per_second=0.16 AND max_concurrent=2
# 5. If either limit exceeded → HTTP 429
#
# ==============================================================================
# ADVANTAGES vs limits:
# ==============================================================================
#
# Declarative config (auditable, versioned in git)
# Change limits = edit TOML + reload (no deploy)
# Rate + Concurrency (limits only does rate)
# Built-in metrics (for billing)
# Zero boilerplate in Python code
#
